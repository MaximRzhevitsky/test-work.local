export default function e(e){let t=0;const n=[],r={},a={},i={},u={},o={},s={},c={};function l(e){return"true"===e.getAttribute("aria-haspopup")}function f(e){return"true"===e.getAttribute("aria-expanded")}function d(e){return"horizontal"===a[e]}function b(e,t,r){let a,i;for(;t;){switch(i=!0,a=t.getAttribute("role"),a&&(a=a.trim().toLowerCase()),a){case"menu":t.tabIndex=-1,N(t,e+1),i=!1;break;case"menuitem":"true"===t.getAttribute("aria-haspopup")&&n.push(t),r.push(t)}i&&t.firstElementChild&&"svg"!==t.firstElementChild.tagName&&b(e,t.firstElementChild,r),t=t.nextElementSibling}}function m(e,t){const n=[];return b(t,e.firstElementChild,n),n}function g(e,t){return!t||!e.nextElementSibling.contains(t)}function p(e){const t="object"==typeof e&&e;for(let e=0;e<n.length;e++){const r=n[e];if(g(r,t)&&f(r)){const e=r.nextElementSibling;e&&(r.setAttribute("aria-expanded","false"),e.classList.remove("open"))}}}function h(e,t){p(t),r[e]&&r[e].forEach((e=>{e===t?(e.tabIndex=0,t.focus()):e.tabIndex=-1}))}function x(e){h(e,s[e])}function A(e){h(e,c[e])}function E(e,t){let n,a;return t===s[e]?n=c[e]:(a=r[e].indexOf(t),n=r[e][a-1]),h(e,n),n}function w(e,t){let n,a;return t===c[e]?n=s[e]:(a=r[e].indexOf(t),n=r[e][a+1]),h(e,n),n}function v(e,t,n){for(let r=t;r<o[e].length;r++)if(n===o[e][r])return r;return-1}function L(e){let n=!1,r=e.getAttribute("role");for(;e&&"menu"!==r&&"menubar"!==r;)(e=e.parentNode)&&(r=e.getAttribute("role"));return e&&(n=`${r}-${function(e){let n=e.dataset.menuId;return n||(e.dataset.menuId=(++t).toString(),n=e.dataset.menuId),n}(e)}`),n}function k(e){let t=e,n=e.getAttribute("role");for(;t&&"menu"!==n&&"menubar"!==n;)t=t.parentNode,t&&(n=t.getAttribute("role"));return t}function S(){for(let e=0;e<n.length;e++)if("true"===n[e].getAttribute("aria-expanded"))return!0;return!1}function C(t){e.setAttribute("data-menubar-item-expanded",t)}function I(){return"true"===e.getAttribute("data-menubar-item-expanded")}function y(e,t){const n=t.nextElementSibling;if(n){const r=t.getBoundingClientRect();return i[e]?(n.style.left=r.width-1+"px",n.classList.add("open")):n.classList.add("open"),t.setAttribute("aria-expanded","true"),C("true"),L(n)}return!1}function T(e){let t,n=e;return!function(e){return!i[e]&&!u[e]}(L(e))?(t=k(e),n=t.previousElementSibling,n.setAttribute("aria-expanded","false"),n.focus(),t.classList.remove("open")):f(e)&&(e.setAttribute("aria-expanded","false"),e.nextElementSibling.classList.remove("open")),n}function D(e){const{currentTarget:t,key:n}=e,a=L(t);let o,s,c,f=!1;switch(n){case" ":l(t)?(s=y(a,t),x(s)):"#"!==t.href&&(p(),C("false")),f=!0;break;case"Esc":case"Escape":c=T(t),o=L(c),C("false"),f=!0;break;case"Up":case"ArrowUp":d(a)?l(t)&&(s=y(a,t),A(s)):E(a,t),f=!0;break;case"ArrowDown":case"Down":d(a)?l(t)&&(s=y(a,t),x(s)):w(a,t),f=!0;break;case"Left":case"ArrowLeft":d(a)?(c=E(a,t),(S()||I())&&y(a,c)):u[a]?(c=T(t),o=L(c),h(o,c)):(c=T(t),o=L(c),c=E(o,c),y(o,c)),f=!0;break;case"Right":case"ArrowRight":d(a)?(c=w(a,t),(S()||I())&&y(a,c)):l(t)?(s=y(a,t),x(s)):(c=function(e){let t,n=L(e),r=e;for(;i[n]||u[n];)t=k(r),r=t.previousElementSibling,n=L(r),t.classList.remove("open");return r.focus(),r}(t),o=L(c),c=w(o,c),y(o,c)),f=!0;break;case"Home":case"PageUp":x(a),f=!0;break;case"End":case"PageDown":A(a),f=!0;break;case"Tab":C("false"),T(t);break;default:1===(b=n).length&&b.match(/\S/)&&(!function(e,t,n){let a,i;n=n.toLowerCase(),a=r[e].indexOf(t)+1,a>=r[e].length&&(a=0),i=v(e,a,n),-1===i&&(i=v(e,0,n)),i>-1&&h(e,r[e][i])}(a,t,n),f=!0)}var b;f&&(e.stopPropagation(),e.preventDefault())}function O(e){const t=e.currentTarget,n=L(t);p(t),l(t)&&y(n,t)}function N(e,t){let n,f;const d=L(e),b=m(e,t);a[d]=function(e){let t=e.getAttribute("aria-orientation");if(!t)switch(e.getAttribute("role")){case"menubar":t="horizontal";break;case"menu":t="vertical"}return t}(e),i[d]="menu"===e.getAttribute("role")&&1===t,u[d]="menu"===e.getAttribute("role")&&t>1,r[d]=[],o[d]=[],s[d]=null,c[d]=null;for(let e=0;e<b.length;e++)n=b[e],f=n.getAttribute("role"),f.indexOf("menuitem")<0||(n.tabIndex=-1,r[d].push(n),o[d].push(n.textContent.trim().toLowerCase()[0]),n.addEventListener("keydown",D),n.addEventListener("pointerover",O),s[d]||(l(n)&&(n.tabIndex=0),s[d]=n),c[d]=n)}N(e,0),e.addEventListener("mouseout",(function(t){t.relatedTarget&&!e.contains(t.relatedTarget)&&p()}),!0);const P=e.querySelector("[role=menuitem]");P&&(P.tabIndex=0)}