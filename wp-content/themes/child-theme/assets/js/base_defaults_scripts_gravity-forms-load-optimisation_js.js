"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(globalThis["webpackChunkmarkup_template"] = globalThis["webpackChunkmarkup_template"] || []).push([["base_defaults_scripts_gravity-forms-load-optimisation_js"],{

/***/ "./base/defaults/scripts/gravity-forms-load-optimisation.js":
/*!******************************************************************!*\
  !*** ./base/defaults/scripts/gravity-forms-load-optimisation.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _libs_live_dom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./libs/live-dom */ \"./base/defaults/scripts/libs/live-dom.js\");\n\nconst scripts = [];\nconst submitted = {\n  id: '0',\n  title: '0',\n  description: '0',\n  placeholder: null,\n  paddingTop: ''\n};\nlet insertScriptsRunning = false;\nlet insertStyles = false;\nlet reloadEventIsSet = false;\nconst insertedScripts = [];\nfunction addStyle(href) {\n  const linkElement = document.createElement('link');\n  linkElement.setAttribute('rel', 'stylesheet');\n  linkElement.setAttribute('type', 'text/css');\n  linkElement.setAttribute('href', href);\n  document.head.appendChild(linkElement);\n}\nfunction addScript(script) {\n  let setId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  const scriptElement = document.createElement('script');\n  scriptElement.async = false;\n  if (setId) {\n    scriptElement.id = script.id;\n  }\n  if (script.src) {\n    scriptElement.src = script.src;\n  }\n  if (script.type) {\n    scriptElement.type = script.type;\n  }\n  document.body.appendChild(scriptElement);\n}\nfunction addScripts() {\n  let start = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n  if (start && insertScriptsRunning) {\n    return;\n  }\n  insertScriptsRunning = true;\n  if (window.gform && window.gform.domLoaded !== true) {\n    window.gform.domLoaded = true;\n  }\n  if (scripts.length) {\n    const script = scripts.shift();\n    if (script.id.startsWith('gform-init-')) {\n      addScript(script, false);\n    } else if (!document.querySelector(`#${script.id}`) && !insertedScripts.includes(script.src)) {\n      addScript(script);\n      insertedScripts.push(script.src);\n    }\n    addScripts();\n  } else {\n    insertScriptsRunning = false;\n  }\n}\nfunction fetchForm(formId, title, description) {\n  return fetch('/wp-content/mu-plugins/wld-plugins/wld-gf-load-optimization/output.php', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      optimisation_gf_form_id: formId,\n      title,\n      description,\n      page_url: window.location.toString()\n    })\n  }).then(response => response.json());\n}\nfunction reloadForm() {\n  submitted.placeholder.style.paddingTop = submitted.paddingTop;\n  fetchForm(submitted.id, submitted.title, submitted.description).then(json => {\n    scripts.push(...json.data.scripts);\n    let conformationText = '';\n    const conformation = submitted.placeholder.querySelector('.gform_confirmation_wrapper');\n    if (conformation) {\n      conformationText = conformation.outerHTML;\n    }\n\n    // eslint-disable-next-line no-use-before-define\n    viewForm(submitted.id, submitted.placeholder, json.data.html + conformationText);\n    submitted.placeholder.style.paddingTop = '';\n  });\n}\nfunction setReloadEvent() {\n  if (reloadEventIsSet) {\n    return;\n  }\n  if (typeof jQuery !== 'undefined') {\n    reloadEventIsSet = true;\n    // We can't catch jQuery custom event\n    jQuery(document).on('gform_confirmation_loaded', () => {\n      reloadForm();\n    });\n  }\n}\n\n/**\n * @param {string}         id\n * @param {HTMLDivElement} placeholder\n * @param {string}         html\n */\nfunction viewForm(id, placeholder, html) {\n  placeholder.innerHTML = html;\n  Array.from(placeholder.querySelectorAll('script')).forEach(oldScript => {\n    const newScript = document.createElement('script');\n    Array.from(oldScript.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value));\n    newScript.appendChild(document.createTextNode(oldScript.innerHTML));\n    oldScript.parentNode.replaceChild(newScript, oldScript);\n  });\n  addScripts(true);\n  placeholder.querySelector('form').addEventListener('submit', () => {\n    submitted.id = id;\n    submitted.placeholder = placeholder;\n    submitted.title = placeholder.querySelector('.gform_title') ? '1' : '0';\n    submitted.description = placeholder.querySelector('.gform_description') ? '1' : '0';\n    submitted.paddingTop = `${placeholder.offsetHeight}px`;\n    const oldConfirmation = submitted.placeholder.querySelector('.gform_confirmation_wrapper');\n    if (oldConfirmation) {\n      oldConfirmation.remove();\n    }\n    setReloadEvent();\n  });\n}\n(0,_libs_live_dom__WEBPACK_IMPORTED_MODULE_0__[\"default\"])('[data-optimisation-gf-form-id]', {\n  firstShow: function initForm() {\n    if (!insertStyles) {\n      addStyle('/wp-content/themes/child-theme/assets/css/gravity-forms.css');\n      insertStyles = true;\n    }\n    const {\n      optimisationGfFormId: formId,\n      title,\n      description\n    } = this.dataset;\n    fetchForm(formId, title, description).then(json => {\n      this.classList.remove('animation');\n      this.classList.add('loaded');\n      scripts.push(...json.data.scripts);\n      viewForm(formId, this, json.data.html);\n    });\n  },\n  show: function startAnimation() {\n    if (!this.classList.contains('loaded')) {\n      this.classList.add('animation');\n    }\n  },\n  hide: function stopAnimation() {\n    if (!this.classList.contains('loaded')) {\n      this.classList.remove('animation');\n    }\n  },\n  setMargin: [600, 400]\n});\n\n//# sourceURL=webpack://markup-template/./base/defaults/scripts/gravity-forms-load-optimisation.js?");

/***/ })

}]);