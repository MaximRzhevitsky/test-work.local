import t from"./live-dom";import e from"./dom-ready";import{getVimeoVideoIdFromUrl as o}from"./get-vimeo-video-id-from-url";import{getYouTubeVideoIdFromUrl as i}from"./get-you-tube-video-id-from-url";const n=void 0===window.HTMLDialogElement;function p(t,e){!0===e?t.showModal():t.show()}n&&(async()=>{import("../../styles/parts/dialog-polyfill.css");const{default:e}=await import("dialog-polyfill");t("dialog").init((function(){e.registerDialog(this)}))})(),e((()=>{t(".popup__close-btn").init((function(){this.addEventListener("click",(function(){const t=this.getAttribute("data-close-popup-id"),e=document.getElementById(t);e.close(),t.includes("iframe")&&e.remove()}))}))}));export const selector='[href^="https://www.youtube.com/watch?v="],:not([href^="#"])[href^="https://vimeo.com/video/"][href^="https://vimeo.com/"]:not([href^="javascript:void(0)"]):not(.target-self)';export function popup(r,l={type:"inline",modal:!0}){e((()=>{t(r).init((function(){this.addEventListener("click",(function(t){if("iframe"===l.type)t.preventDefault(),function(t,e){let r=t.getAttribute("href");const l=i(r);if(l)r=`https://www.youtube.com/embed/${l}/?autoplay=1&rel=0`;else{const t=o(r);t&&(r=`https://player.vimeo.com/video/${t}/?title=0&byline=0&portrait=0`)}const s=document.createElement("dialog");s.setAttribute("id","popup-iframe"),s.classList.add("popup"),s.innerHTML=`\n\t\t<div class="popup__content">\n\t\t<iframe src="${r}"\n\t\t\t\tallow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"\n\t\t\t\tallowfullscreen></iframe>\n\t\t</div>\n\t\t<button class="popup__close-btn" type="button" data-close-popup-id="popup-iframe"><span>Close</span></button>\n\t`,document.body.appendChild(s),n?setTimeout((()=>p(s,e)),500):p(s,e)}(this,l.modal);else{const t=this.getAttribute("href")?this.getAttribute("href").slice(1):this.getAttribute("data-popup-id");p(document.getElementById(t),l.modal)}}))}))}))}