export default function e(e){let t=0;const n=[],r={},a={},i={},o={},u={},s={};function c(e){return"true"===e.getAttribute("aria-haspopup")}function l(e){return"true"===e.getAttribute("aria-expanded")}function d(e){return"horizontal"===a[e]}function f(e,t,r){let a,i;for(;t;){switch(i=!0,a=t.getAttribute("data-role"),a&&(a=a.trim().toLowerCase()),a){case"menu":t.tabIndex=-1,R(t,e+1),i=!1;break;case"menuitem":"true"===t.getAttribute("aria-haspopup")&&n.push(t),r.push(t)}i&&t.firstElementChild&&"svg"!==t.firstElementChild.tagName&&f(e,t.firstElementChild,r),t=t.nextElementSibling}}function b(e,t){const n=[];return f(t,e.firstElementChild,n),n}function g(e,t){return!t||!e.nextElementSibling.contains(t)}function m(e){const t="object"==typeof e&&e;for(let e=0;e<n.length;e++){const r=n[e];if(g(r,t)&&l(r)){const e=r.nextElementSibling;e&&(r.setAttribute("aria-expanded","false"),e.classList.remove("open"))}}}function p(e,t){m(t),r[e]&&r[e].forEach((e=>{e===t?(e.tabIndex=0,t.focus()):e.tabIndex=-1}))}function h(e){p(e,u[e])}function A(e){p(e,s[e])}function x(e,t){let n,a;return t===u[e]?n=s[e]:(a=r[e].indexOf(t),n=r[e][a-1]),p(e,n),n}function E(e,t){let n,a;return t===s[e]?n=u[e]:(a=r[e].indexOf(t),n=r[e][a+1]),p(e,n),n}function v(e){let n=!1,r=e.getAttribute("data-role");for(;e&&"menu"!==r&&"menubar"!==r;)(e=e.parentNode)&&(r=e.getAttribute("data-role"));return e&&(n=`${r}-${function(e){let n=e.dataset.menuId;return n||(e.dataset.menuId=(++t).toString(),n=e.dataset.menuId),n}(e)}`),n}function L(e){let t=e,n=e.getAttribute("data-role");for(;t&&"menu"!==n&&"menubar"!==n;)t=t.parentNode,t&&(n=t.getAttribute("data-role"));return t}function w(){for(let e=0;e<n.length;e++)if("true"===n[e].getAttribute("aria-expanded"))return!0;return!1}function k(t){e.setAttribute("data-menubar-item-expanded",t)}function S(){return"true"===e.getAttribute("data-menubar-item-expanded")}function I(e,t){const n=t.nextElementSibling;if(n){const r=t.getBoundingClientRect();return i[e]?(n.style.left=r.width-1+"px",n.classList.add("open")):n.classList.add("open"),t.setAttribute("aria-expanded","true"),k("true"),v(n)}return!1}function y(e){let t,n=e;return!function(e){return!i[e]&&!o[e]}(v(e))?(t=L(e),n=t.previousElementSibling,n.setAttribute("aria-expanded","false"),n.focus(),t.classList.remove("open")):l(e)&&(e.setAttribute("aria-expanded","false"),e.nextElementSibling.classList.remove("open")),n}function T(e){const{currentTarget:t,key:n}=e,r=v(t);let a,u,s,l=!1;switch(document.querySelectorAll(".menu-tooltip").forEach((e=>{e.remove()})),n){case" ":c(t)?(u=I(r,t),h(u)):"#"!==t.href&&(m(),k("false")),l=!0;break;case"Esc":case"Escape":s=y(t),a=v(s),k("false"),l=!0;break;case"Up":case"ArrowUp":d(r)?c(t)&&(u=I(r,t),A(u)):x(r,t),l=!0;break;case"ArrowDown":case"Down":d(r)?c(t)&&(u=I(r,t),h(u)):E(r,t),l=!0;break;case"Left":case"ArrowLeft":d(r)?(s=x(r,t),(w()||S())&&I(r,s)):o[r]?(s=y(t),a=v(s),p(a,s)):(s=y(t),a=v(s),s=x(a,s),I(a,s)),l=!0;break;case"Right":case"ArrowRight":d(r)?(s=E(r,t),(w()||S())&&I(r,s)):c(t)?(u=I(r,t),h(u)):(s=function(e){let t,n=v(e),r=e;for(;i[n]||o[n];)t=L(r),r=t.previousElementSibling,n=v(r),t.classList.remove("open");return r.focus(),r}(t),a=v(s),s=E(a,s),I(a,s)),l=!0;break;case"Home":case"PageUp":h(r),l=!0;break;case"End":case"PageDown":A(r),l=!0;break;case"Tab":k("false"),y(t)}l&&(e.stopPropagation(),e.preventDefault())}function C(e){const t=e.currentTarget,n=v(t);m(t),c(t)&&I(n,t)}function R(e,t){const n=v(e),l=b(e,t);a[n]=function(e){let t=e.getAttribute("aria-orientation");if(!t)switch(e.getAttribute("data-role")){case"menubar":t="horizontal";break;case"menu":t="vertical"}return t}(e),i[n]="menu"===e.getAttribute("data-role")&&1===t,o[n]="menu"===e.getAttribute("data-role")&&t>1,r[n]=[],u[n]=null,s[n]=null;for(let e=0;e<l.length;e++){const t=l[e];t.getAttribute("data-role").indexOf("menuitem")<0||(t.tabIndex=-1,r[n].push(t),t.addEventListener("keydown",T),t.addEventListener("pointerover",C),u[n]||(c(t)&&(t.tabIndex=0),u[n]=t),s[n]=t)}}R(e,0),e.addEventListener("mouseout",(function(t){t.relatedTarget&&!e.contains(t.relatedTarget)&&m()}),!0);const D=e.querySelector("[data-role=menuitem]");D&&(D.tabIndex=0,D.addEventListener("keyup",(function(e){const{currentTarget:t,key:r}=e,a=n.length?"use &#8592; &#8595; &#8594; to navigate":"use &#8592; / &#8594; to navigate";"Tab"!==r&&"Left"!==r&&"ArrowLeft"!==r&&"Right"!==r&&"ArrowRight"!==r||(t.innerHTML+=`<span class="menu-tooltip" aria-hidden="true">${a}</span>`)})))}